---
title: "Widgets"
description: "Explore the widgets you can use in the Next-js "
---

## Installation

<Tabs>
  <Tab title="npm"></Tab>
  <Tab title="pnpm">```bash yarn add @runonatlas/next ```</Tab>
  <Tab title="yarn">```bash yarn add @runonatlas/next ```</Tab>
</Tabs>

```bash
npm install @runonatlas/next
```

## Initialization

### Frontend

To initialize the application, you need to create a client provider component and wrap your application with it. Since Atlas needs to authenticate with your backend and verify that users are only accessing what they can, you will need to place it under your authentication provider.

<Tabs>
  <Tab title="Using Clerk">
    When using Clerk, you just need to pass the getAuth function and the userId to the Atlas Provider.

    <CodeGroup>

    ```typescript src/atlas/client.tsx [expandable]
    "use client";

    import { useAuth } from "@clerk/nextjs";
    import { AtlasProvider } from "@runonatlas/next/client";

    export function AtlasClientProvider({
      children,
    }: {
      children: React.ReactNode;
    }) {
      const { userId, getToken } = useAuth();

      return (
        <AtlasProvider getAuth={getToken} userId={userId}>
          {children}
        </AtlasProvider>
      );
    }
    ```


    ```typescript src/app/layout.tsx [expandable]
    export default function RootLayout({
      children,
    }: Readonly<{
      children: React.ReactNode;
    }>) {
      return (
        <ClerkProvider>
          <AtlasClientProvider>
    		<App />
          </AtlasClientProvider>
        </ClerkProvider>
      );
    }

    ```

    </CodeGroup>

  </Tab>
  <Tab title="Using a cookie-based provider">
    When using a cookie-based provider, the authentication against your backend is done automatically. Hence, you just need to pass the `userId` .

    <CodeGroup>

    ```typescript src/atlas/client.tsx [expandable]
    "use client";

    import { AtlasProvider } from "@runonatlas/next/client";
    import { useCookieBasedAuthentication } from "your-auth-provider";

    export function AtlasClientProvider({
      children,
    }: {
      children: React.ReactNode;
    }) {
      const { userId } = useCookieBasedAuthentication(); // Change this for the hook you are using

      return (
        <AtlasProvider userId={userId}>
          {children}
        </AtlasProvider>
      );
    }
    ```


    ```typescript src/app/layout.tsx [expandable]
    export default function RootLayout({
      children,
    }: Readonly<{
      children: React.ReactNode;
    }>) {
      return (
        <AuthenticationProvider>
          <AtlasClientProvider>
    		<App />
          </AtlasClientProvider>
        </AuthenticationProvider>
      );
    }

    ```

    </CodeGroup>

  </Tab>
</Tabs>

<Accordion title="Using a different host for your backend?" icon="server">
  You can specify the host of your backend when instantiating the provider.

```typescript
return (
  <AtlasProvider host="https://my-backend.domain.com">
    {" "}
    // Don't forget the other props!
    {children}
  </AtlasProvider>
);
```

</Accordion>

### Backend

You will need to initialize the client in the backend using:

- the Atlas API key
- a callback that returns the user that performed the request. This callback will depend on the authentication provider you are using.

<CodeGroup>

```bash .env
ATLAS_API_KEY="INSERT_YOUR_ATLAS_API_KEY"
```

```typescript src/atlas/server.ts (Clerk example) [expandable]
import { AtlasNextServerClient } from "@runonatlas/private-next/server";
import { auth } from "@clerk/nextjs/server";

export const atlasServerClient = new AtlasNextServerClient(
  process.env.ATLAS_API_KEY!,
  async () => {
    const { userId } = await auth();

    return userId;
  }
);
```

```typescript src/app/api/atlas-api/[slug]/route.ts [expandable]
import { atlasServerClient } from "@/atlas/server";
import { NextRequest } from "next/server";

export async function GET(
  request: NextRequest,
  { params }: { params: Promise<{ slug: string }> }
) {
  const { slug } = await params;

  return (
    atlasServerClient.router[slug]?.GET?.(request) ??
    new Response("Not found", { status: 404 })
  );
}

export async function POST(
  request: NextRequest,
  { params }: { params: Promise<{ slug: string }> }
) {
  const { slug } = await params;

  return (
    atlasServerClient.router[slug]?.POST?.(request) ??
    new Response("Not found", { status: 404 })
  );
}
```

</CodeGroup>
